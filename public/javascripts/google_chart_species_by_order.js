// Generated by CoffeeScript 1.4.0
(function() {
  var drawChartSpeciesByOrder;

  $(document).ready(function() {
    if (($('#chart_div').length)) {
      if (Modernizr.svg) {
        $.ajax({
          url: '/birding/ordersajax',
          cache: false,
          dataType: 'json',
          success: function(data) {
            mooredatabase.drawChartSpeciesByOrder(data);
            return true;
          }
        });
      } else {
        $("#chart_div").html('<p>Your browser cannot display Google charts.</p>');
      }
    }
    return true;
  });

  google.load('visualization', '1.0', {
    'packages': ['corechart']
  });

  drawChartSpeciesByOrder = function(dataPoints) {
    var chart, chartData, data, i, options, _i, _ref;
    chartData = [];
    for (i = _i = 0, _ref = dataPoints.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
      chartData.push([dataPoints[i]['order_name'], parseInt(dataPoints[i]['speciesCount'])]);
    }
    data = new google.visualization.DataTable();
    data.addColumn('string', 'Order');
    data.addColumn('number', 'Species');
    data.addRows(chartData);
    chart = new google.visualization.PieChart(document.getElementById('chart_div'));
    options = {
      width: 800,
      height: 400,
      title: 'Bird Species Sighted By Order'
    };
    return chart.draw(data, options);
  };

  mooredatabase.drawChartSpeciesByOrder = drawChartSpeciesByOrder;

}).call(this);
