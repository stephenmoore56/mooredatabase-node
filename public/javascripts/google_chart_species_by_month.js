// Generated by CoffeeScript 1.6.1
(function() {
  var drawChartSpeciesByMonth;

  $(document).ready(function() {
    if ($('#chart_div').length) {
      if (Modernizr.svg) {
        $.getScript("http://moore-database.com/zend/public/sighting/monthsjsonp");
      } else {
        $("#chart_div").html('<p>Your browser cannot display Google charts.</p>');
      }
    }
    return true;
  });

  window.mooredatabase = mooredatabase || {};

  google.load('visualization', '1.0', {
    'packages': ['corechart']
  });

  drawChartSpeciesByMonth = function(dataPoints) {
    var chart, chartData, data, i, options, _i, _ref;
    chartData = [];
    for (i = _i = 0, _ref = dataPoints.length; 0 <= _ref ? _i < _ref : _i > _ref; i = 0 <= _ref ? ++_i : --_i) {
      chartData.push([parseInt(dataPoints[i][0]), parseInt(dataPoints[i][1]), parseInt(dataPoints[i][2])]);
    }
    data = new google.visualization.DataTable();
    data.addColumn('number', 'Month');
    data.addColumn('number', 'Species');
    data.addColumn('number', 'Trips');
    data.addRows(chartData);
    chart = new google.visualization.LineChart(document.getElementById('chart_div'));
    google.visualization.events.addListener(chart, 'select', function() {
      var monthNumber, myDate, selectedItem, value;
      selectedItem = chart.getSelection()[0];
      if (selectedItem.row !== null && selectedItem.column !== null) {
        value = data.getValue(selectedItem.row, 0);
        myDate = new Date(value + " 01, 1900");
        monthNumber = myDate.getMonth() + 1;
        if (selectedItem.column === 1) {
          return window.location = "/zend/public/sighting/month/monthnumber/" + monthNumber;
        } else if (selectedItem.column === 2) {
          return window.location = "/zend/public/trip/month/monthnumber/" + monthNumber;
        }
      } else {
        if (selectedItem.column === 1) {
          return window.location = "/zend/public/sighting";
        } else {
          return window.location = "/zend/public/location";
        }
      }
    });
    options = {
      width: 600,
      height: 240,
      pointSize: 5,
      title: 'Bird Species and Trips By Month',
      hAxis: {
        title: 'Month',
        titleTextStyle: {
          color: '#000'
        },
        gridlines: {
          color: '#CCC',
          count: 12
        },
        baselineColor: '#CCC'
      },
      vAxis: {
        title: 'Species/Trips',
        titleTextStyle: {
          color: '#000'
        },
        baselineColor: '#CCC'
      }
    };
    return chart.draw(data, options);
  };

  mooredatabase.drawChartSpeciesByMonth = drawChartSpeciesByMonth;

}).call(this);
